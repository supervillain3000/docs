
## Подготовительные шаги

Для управления ВМ с помощью OpenStack CLI нужен ID виртуальной машины.

1. Выполните [установку]() и пройдите [аутентификацию]() OpenStack CLI.
2. Получите ID ВМ с которой необходимо выполнить действия командой:

```shell
openstack server list
```

## Действия с виртуальной машиной

1. [Перейдите](https://console.ps.kz/cloud/) в консоль управления PS Cloud.
2. Выберите услугу облачных серверов и перейдите в проект облачного сервера.
3. Откройте вкладку **Cерверы**.
4. Измените состояние ВМ одним из способов:
	- Через контекстное меню — для одной ВМ:
		1. В списке виртуальных машин найдите ВМ, состояние которой необходимо изменить.
		2. Откройте контекстное меню и выберите необходимое действие.

	- На странице виртуальной машины:
		1. В списке виртуальных машин нажмите на название ВМ, состояние которой необходимо изменить.
		2. Нажмите кнопку **Управление**.
		3. Выберите и подтвердите действие с ВМ.


С помощью описанных выше шагов вы можете выполнить необходимые действия с виртуальной машиной c помощью консоли управления PS Cloud, описание которых предоставлено ниже.

#### Изменение типа конфигурации и переименование ВМ

С помощью консоли управления можно изменить [тип конфигурации]() ВМ - количество процессоров и объем оперативной памяти, а также переименовать виртуальную машину. 

`При изменении типа конфигурации виртуальная машина будет перезагружена.`

Чтобы переименовать ВМ с помощью OpenStack CLI введите команду:

```
openstack server set --name <новое имя> <ID виртуальной машины>
```

Чтобы изменить тип конфигурации с помощью OpenStack CLI:

1. Получите список доступных типов конфигураций и скопируйте ID нужного типа конфигурации:

```
openstack flavor list
```

2. Выполните команду:

```
openstack server resize --flavor <ID типа конфигурации> <ID виртуальной машины>
```

#### Остановка и перезагрузка ВМ

**Остановка** ВМ подразумевает собой корректное завершение работы ОС. 

**Перезагрука** бывает двух видов:
 - **Холодная перезагрука или мягкая** (soft).
 - **Горячая перезагрука или принудительная** (hard).

**Холодная перезагрузка** выполняется точно так же как выполнялась бы на ВМ с помощью команды `reboot` и предполагает корректное завершение работы ОС ВМ.

**Горячая перезагрузка** или принудительная соответствует отключению питания и может быть полезна когда виртуальная машина не отвечает. 

Для перезагрузки ВМ с помощью CLI введите команду с опциональными параметрами:

```
openstack server reboot [--hard | --soft] [--wait] <ID виртуальной машины>
```

Для остановки ВМ с помощью CLI введите команду:

```
openstack server stop <ID виртуальной машины>
```

Для запуска ВМ с помощью CLI введите команду:

```
openstack server start <ID виртуальной машины>
```

#### Пауза

Действие **Поставить на паузу** сохраняет состояние виртуальной машины в ОЗУ. Виртуальная машина получает статус `PAUSED`. В статусе паузы с виртуальной машиной нельзя выполнять действия по включению, выключению и перезагрузке. 

После снятия с паузы, виртуальная машина начнет свою работу с того состояния, в котором была поставлена на паузу. Это может быть полезно для создания [снимка диска]().

Для установки статуса паузы для ВМ с помощью CLI выполните команду:

```
openstack server pause <ID виртуальной машины>
```

Для снятия статуса паузы с помощью CLI:

```
openstack server unpause <ID виртуальной машины>
```

#### Плавающий IP

Действие **Привязать плавающий IP** позволяет подключить к [порту]() ВМ публичный IP адрес, необходимый для доступа к ВМ по публичному IP. Подробнее про [плавающий IP]().

Для подключения плавающего IP с помощью CLI:

1. Скопируйте ID сети FloatingIP Net:

```
openstack network list
```

2. Создайте плавающий IP в сети FloatingIP Net:

```
openstack floating ip create <ID сети FloatingIP Net>
```

3. Скопируйте IP-адрес:

```
openstack floating ip list
```

4. Подключите плавающий IP адрес к ВМ:

```
openstack server add floating ip <ID виртуальной машины> <IP-адрес>
```

Для отключения плавающего IP с помощью CLI введите команду:

```
openstack server remove floating ip <ID виртуальной машины> <IP-адрес>
```

#### Архивация

Действие **Архивировать** останавливает ВМ, сохраняет ее текущее состояние и переходит в статус `SHELVED_OFFLOADED`. ВМ может быть запущена с того же состояния с помощью действия **Разархивировать**. 

Виртуальную машину нельзя запустить или остановить, а также перезагрузить. Невозможно заменить диски и изменить настройки сетевых интерфейсов архивированной ВМ.

Для архивации ВМ с помощью CLI выполните команду:

```
openstack server shelve <ID виртуальной машины>
```

Для разархивации ВМ с помощью CLI выполните команду:

```
openstack server unshelve <ID виртуальной машины>
```

#### Удаление

По умолчанию, удаление основного диска (root-диск) отключено и после удаления ВМ подключенный к ней диск сохранится. 

Проверить политику удаления дисков вы можете с помощью [OpenStack CLI]():
```
openstack server show <ID виртуальной машины>
```
Найдите строку `volumes_attached`. В ней перечислены ID дисков и указана политика их удаления — свойство `delete_on_termination` (`True` или `False`).

Для удаления ВМ с помощью CLI введите команду:

```
openstack server delete <ID виртуальной машины>
```